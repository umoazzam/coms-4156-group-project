<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/client/app.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/client/app.py" />
              <option name="originalContent" value="from flask import Flask, render_template, request, jsonify&#10;from citation_client import CitationClient&#10;import json&#10;&#10;app = Flask(__name__)&#10;&#10;# Initialize the citation client&#10;# Using port 8081 for dev profile&#10;citation_client = CitationClient(base_url=&quot;http://localhost:8081&quot;)&#10;&#10;# Sample data for required readings - these would typically come from a database&#10;SAMPLE_READINGS = []&#10;&#10;def initialize_sample_data():&#10;    &quot;&quot;&quot;Initialize sample readings by creating them through the API&quot;&quot;&quot;&#10;    global SAMPLE_READINGS&#10;&#10;    # Sample book&#10;    book_data = citation_client.create_book(&#10;        title=&quot;Design Patterns: Elements of Reusable Object-Oriented Software&quot;,&#10;        author=&quot;Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides&quot;,&#10;        publisher=&quot;Addison-Wesley Professional&quot;,&#10;        year=1994,&#10;        isbn=&quot;978-0201633610&quot;&#10;    )&#10;&#10;    # Sample article&#10;    article_data = citation_client.create_article(&#10;        title=&quot;The Cathedral and the Bazaar&quot;,&#10;        author=&quot;Eric S. Raymond&quot;,&#10;        journal=&quot;First Monday&quot;,&#10;        year=1998,&#10;        doi=&quot;10.5210/fm.v3i3.578&quot;,&#10;        volume=&quot;3&quot;,&#10;        issue=&quot;3&quot;&#10;    )&#10;&#10;    # Sample video&#10;    video_data = citation_client.create_video(&#10;        title=&quot;Clean Code: A Handbook of Agile Software Craftsmanship&quot;,&#10;        author=&quot;Robert C. Martin&quot;,&#10;        platform=&quot;YouTube&quot;,&#10;        year=2019,&#10;        url=&quot;https://www.youtube.com/watch?v=7EmboKQH8lM&quot;,&#10;        duration=3600&#10;    )&#10;&#10;    # Store the created readings&#10;    if book_data:&#10;        SAMPLE_READINGS.append(book_data)&#10;    if article_data:&#10;        SAMPLE_READINGS.append(article_data)&#10;    if video_data:&#10;        SAMPLE_READINGS.append(video_data)&#10;&#10;    # If API calls failed, use fallback static data&#10;    if not SAMPLE_READINGS:&#10;        SAMPLE_READINGS.extend([&#10;            {&#10;                &quot;id&quot;: 1,&#10;                &quot;title&quot;: &quot;Design Patterns: Elements of Reusable Object-Oriented Software&quot;,&#10;                &quot;author&quot;: &quot;Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides&quot;,&#10;                &quot;type&quot;: &quot;BOOK&quot;,&#10;                &quot;publisher&quot;: &quot;Addison-Wesley Professional&quot;,&#10;                &quot;year&quot;: 1994,&#10;                &quot;isbn&quot;: &quot;978-0201633610&quot;&#10;            },&#10;            {&#10;                &quot;id&quot;: 2,&#10;                &quot;title&quot;: &quot;The Cathedral and the Bazaar&quot;,&#10;                &quot;author&quot;: &quot;Eric S. Raymond&quot;,&#10;                &quot;type&quot;: &quot;ARTICLE&quot;,&#10;                &quot;journal&quot;: &quot;First Monday&quot;,&#10;                &quot;year&quot;: 1998,&#10;                &quot;doi&quot;: &quot;10.5210/fm.v3i3.578&quot;,&#10;                &quot;volume&quot;: &quot;3&quot;,&#10;                &quot;issue&quot;: &quot;3&quot;&#10;            },&#10;            {&#10;                &quot;id&quot;: 3,&#10;                &quot;title&quot;: &quot;Clean Code: A Handbook of Agile Software Craftsmanship&quot;,&#10;                &quot;author&quot;: &quot;Robert C. Martin&quot;,&#10;                &quot;type&quot;: &quot;VIDEO&quot;,&#10;                &quot;platform&quot;: &quot;YouTube&quot;,&#10;                &quot;year&quot;: 2019,&#10;                &quot;url&quot;: &quot;https://www.youtube.com/watch?v=7EmboKQH8lM&quot;,&#10;                &quot;duration&quot;: 3600&#10;            }&#10;        ])&#10;&#10;@app.route('/')&#10;def index():&#10;    &quot;&quot;&quot;Main page showing the required readings list&quot;&quot;&quot;&#10;    # Check if citation service is available&#10;    service_status = citation_client.health_check()&#10;&#10;    # Initialize sample data if not already done&#10;    if not SAMPLE_READINGS:&#10;        initialize_sample_data()&#10;&#10;    return render_template('index.html',&#10;                         readings=SAMPLE_READINGS,&#10;                         service_status=service_status)&#10;&#10;@app.route('/generate_citation', methods=['POST'])&#10;def generate_citation():&#10;    &quot;&quot;&quot;Generate citation for a specific source&quot;&quot;&quot;&#10;    try:&#10;        data = request.get_json()&#10;        source_id = data.get('source_id')&#10;        source_type = data.get('source_type', 'BOOK')&#10;        style = data.get('style', 'MLA').upper()&#10;&#10;        if not source_id:&#10;            return jsonify({&#10;                'success': False,&#10;                'error': 'Source ID is required'&#10;            }), 400&#10;&#10;        # Generate citation using the API&#10;        citation = citation_client.generate_citation(source_id, source_type, style)&#10;&#10;        if citation:&#10;            return jsonify({&#10;                'success': True,&#10;                'citation': citation,&#10;                'style': style&#10;            })&#10;        else:&#10;            return jsonify({&#10;                'success': False,&#10;                'error': f'Failed to generate {style} citation. Please check if the Citation Service is running.'&#10;            }), 500&#10;&#10;    except Exception as e:&#10;        return jsonify({&#10;            'success': False,&#10;            'error': f'Internal error: {str(e)}'&#10;        }), 500&#10;&#10;@app.route('/health')&#10;def health_check():&#10;    &quot;&quot;&quot;Health check endpoint for the client application&quot;&quot;&quot;&#10;    service_status = citation_client.health_check()&#10;    return jsonify({&#10;        'client_status': 'healthy',&#10;        'citation_service_status': 'connected' if service_status else 'disconnected'&#10;    })&#10;&#10;@app.route('/api/readings')&#10;def get_readings():&#10;    &quot;&quot;&quot;API endpoint to get all readings (for potential API consumers)&quot;&quot;&quot;&#10;    return jsonify({&#10;        'readings': SAMPLE_READINGS,&#10;        'count': len(SAMPLE_READINGS)&#10;    })&#10;&#10;@app.route('/refresh_data', methods=['POST'])&#10;def refresh_data():&#10;    &quot;&quot;&quot;Endpoint to refresh sample data from the API&quot;&quot;&quot;&#10;    global SAMPLE_READINGS&#10;    SAMPLE_READINGS.clear()&#10;    initialize_sample_data()&#10;&#10;    return jsonify({&#10;        'success': True,&#10;        'message': f'Sample data refreshed. {len(SAMPLE_READINGS)} readings loaded.',&#10;        'readings_count': len(SAMPLE_READINGS)&#10;    })&#10;&#10;if __name__ == '__main__':&#10;    print(&quot;Starting University Library Citation Client...&quot;)&#10;    print(&quot;This client will connect to the Citation Service at http://localhost:8081&quot;)&#10;    print(&quot;Make sure your Citation Service is running before generating citations.&quot;)&#10;    print(&quot;\nAccess the application at: http://localhost:5001&quot;)&#10;&#10;    # Initialize sample data on startup&#10;    initialize_sample_data()&#10;&#10;    # Run the Flask development server&#10;    app.run(debug=True, host='0.0.0.0', port=5001)&#10;" />
              <option name="updatedContent" value="from flask import Flask, render_template, request, jsonify&#10;from citation_client import CitationClient&#10;import json&#10;&#10;app = Flask(__name__)&#10;&#10;# Initialize the citation client&#10;# Using port 8081 for dev profile&#10;citation_client = CitationClient(base_url=&quot;http://localhost:8081&quot;)&#10;&#10;# Sample data for required readings - these would typically come from a database&#10;SAMPLE_READINGS = []&#10;&#10;def initialize_sample_data():&#10;    &quot;&quot;&quot;Initialize sample readings by creating them through the API&quot;&quot;&quot;&#10;    global SAMPLE_READINGS&#10;&#10;    # Sample book&#10;    book_data = citation_client.create_book(&#10;        title=&quot;Design Patterns: Elements of Reusable Object-Oriented Software&quot;,&#10;        author=&quot;Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides&quot;,&#10;        publisher=&quot;Addison-Wesley Professional&quot;,&#10;        year=1994,&#10;        isbn=&quot;978-0201633610&quot;&#10;    )&#10;&#10;    # Sample article&#10;    article_data = citation_client.create_article(&#10;        title=&quot;The Cathedral and the Bazaar&quot;,&#10;        author=&quot;Eric S. Raymond&quot;,&#10;        journal=&quot;First Monday&quot;,&#10;        year=1998,&#10;        doi=&quot;10.5210/fm.v3i3.578&quot;,&#10;        volume=&quot;3&quot;,&#10;        issue=&quot;3&quot;&#10;    )&#10;&#10;    # Sample video&#10;    video_data = citation_client.create_video(&#10;        title=&quot;Clean Code: A Handbook of Agile Software Craftsmanship&quot;,&#10;        author=&quot;Robert C. Martin&quot;,&#10;        platform=&quot;YouTube&quot;,&#10;        year=2019,&#10;        url=&quot;https://www.youtube.com/watch?v=7EmboKQH8lM&quot;,&#10;        duration=3600&#10;    )&#10;&#10;    # Store the created readings and ensure they have a 'type' field&#10;    if book_data:&#10;        book_data['type'] = 'BOOK'&#10;        SAMPLE_READINGS.append(book_data)&#10;    if article_data:&#10;        article_data['type'] = 'ARTICLE'&#10;        SAMPLE_READINGS.append(article_data)&#10;    if video_data:&#10;        video_data['type'] = 'VIDEO'&#10;        SAMPLE_READINGS.append(video_data)&#10;&#10;    # If API calls failed, use fallback static data&#10;    if not SAMPLE_READINGS:&#10;        SAMPLE_READINGS.extend([&#10;            {&#10;                &quot;id&quot;: 1,&#10;                &quot;title&quot;: &quot;Design Patterns: Elements of Reusable Object-Oriented Software&quot;,&#10;                &quot;author&quot;: &quot;Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides&quot;,&#10;                &quot;type&quot;: &quot;BOOK&quot;,&#10;                &quot;publisher&quot;: &quot;Addison-Wesley Professional&quot;,&#10;                &quot;year&quot;: 1994,&#10;                &quot;isbn&quot;: &quot;978-0201633610&quot;&#10;            },&#10;            {&#10;                &quot;id&quot;: 2,&#10;                &quot;title&quot;: &quot;The Cathedral and the Bazaar&quot;,&#10;                &quot;author&quot;: &quot;Eric S. Raymond&quot;,&#10;                &quot;type&quot;: &quot;ARTICLE&quot;,&#10;                &quot;journal&quot;: &quot;First Monday&quot;,&#10;                &quot;year&quot;: 1998,&#10;                &quot;doi&quot;: &quot;10.5210/fm.v3i3.578&quot;,&#10;                &quot;volume&quot;: &quot;3&quot;,&#10;                &quot;issue&quot;: &quot;3&quot;&#10;            },&#10;            {&#10;                &quot;id&quot;: 3,&#10;                &quot;title&quot;: &quot;Clean Code: A Handbook of Agile Software Craftsmanship&quot;,&#10;                &quot;author&quot;: &quot;Robert C. Martin&quot;,&#10;                &quot;type&quot;: &quot;VIDEO&quot;,&#10;                &quot;platform&quot;: &quot;YouTube&quot;,&#10;                &quot;year&quot;: 2019,&#10;                &quot;url&quot;: &quot;https://www.youtube.com/watch?v=7EmboKQH8lM&quot;,&#10;                &quot;duration&quot;: 3600&#10;            }&#10;        ])&#10;&#10;@app.route('/')&#10;def index():&#10;    &quot;&quot;&quot;Main page showing the required readings list&quot;&quot;&quot;&#10;    # Check if citation service is available&#10;    service_status = citation_client.health_check()&#10;&#10;    # Initialize sample data if not already done&#10;    if not SAMPLE_READINGS:&#10;        initialize_sample_data()&#10;&#10;    return render_template('index.html',&#10;                         readings=SAMPLE_READINGS,&#10;                         service_status=service_status)&#10;&#10;@app.route('/generate_citation', methods=['POST'])&#10;def generate_citation():&#10;    &quot;&quot;&quot;Generate citation for a specific source&quot;&quot;&quot;&#10;    try:&#10;        data = request.get_json()&#10;        source_id = data.get('source_id')&#10;        source_type = data.get('source_type', 'BOOK')&#10;        style = data.get('style', 'MLA').upper()&#10;&#10;        if not source_id:&#10;            return jsonify({&#10;                'success': False,&#10;                'error': 'Source ID is required'&#10;            }), 400&#10;&#10;        # Generate citation using the API&#10;        citation = citation_client.generate_citation(source_id, source_type, style)&#10;&#10;        if citation:&#10;            return jsonify({&#10;                'success': True,&#10;                'citation': citation,&#10;                'style': style&#10;            })&#10;        else:&#10;            return jsonify({&#10;                'success': False,&#10;                'error': f'Failed to generate {style} citation. Please check if the Citation Service is running.'&#10;            }), 500&#10;&#10;    except Exception as e:&#10;        return jsonify({&#10;            'success': False,&#10;            'error': f'Internal error: {str(e)}'&#10;        }), 500&#10;&#10;@app.route('/health')&#10;def health_check():&#10;    &quot;&quot;&quot;Health check endpoint for the client application&quot;&quot;&quot;&#10;    service_status = citation_client.health_check()&#10;    return jsonify({&#10;        'client_status': 'healthy',&#10;        'citation_service_status': 'connected' if service_status else 'disconnected'&#10;    })&#10;&#10;@app.route('/api/readings')&#10;def get_readings():&#10;    &quot;&quot;&quot;API endpoint to get all readings (for potential API consumers)&quot;&quot;&quot;&#10;    return jsonify({&#10;        'readings': SAMPLE_READINGS,&#10;        'count': len(SAMPLE_READINGS)&#10;    })&#10;&#10;@app.route('/refresh_data', methods=['POST'])&#10;def refresh_data():&#10;    &quot;&quot;&quot;Endpoint to refresh sample data from the API&quot;&quot;&quot;&#10;    global SAMPLE_READINGS&#10;    SAMPLE_READINGS.clear()&#10;    initialize_sample_data()&#10;&#10;    return jsonify({&#10;        'success': True,&#10;        'message': f'Sample data refreshed. {len(SAMPLE_READINGS)} readings loaded.',&#10;        'readings_count': len(SAMPLE_READINGS)&#10;    })&#10;&#10;if __name__ == '__main__':&#10;    print(&quot;Starting University Library Citation Client...&quot;)&#10;    print(&quot;This client will connect to the Citation Service at http://localhost:8081&quot;)&#10;    print(&quot;Make sure your Citation Service is running before generating citations.&quot;)&#10;    print(&quot;\nAccess the application at: http://localhost:5001&quot;)&#10;&#10;    # Initialize sample data on startup&#10;    initialize_sample_data()&#10;&#10;    # Run the Flask development server&#10;    app.run(debug=True, host='0.0.0.0', port=5001)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/client/templates/index.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/client/templates/index.html" />
              <option name="originalContent" value="&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Columbia University Library - Required Readings&lt;/title&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;{{ url_for('static', filename='style.css') }}&quot;&gt;&#10;    &lt;link href=&quot;https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;    &lt;div class=&quot;container&quot;&gt;&#10;        &lt;header class=&quot;header&quot;&gt;&#10;            &lt;div class=&quot;university-logo&quot;&gt;&#10;                &lt;h1&gt;Columbia University Libraries&lt;/h1&gt;&#10;                &lt;p class=&quot;subtitle&quot;&gt;Academic Resource Management System&lt;/p&gt;&#10;            &lt;/div&gt;&#10;        &lt;/header&gt;&#10;&#10;        &lt;main class=&quot;main-content&quot;&gt;&#10;            &lt;div class=&quot;course-header&quot;&gt;&#10;                &lt;h2 class=&quot;course-title&quot;&gt;COMS W 4156: Advanced Software Engineering&lt;/h2&gt;&#10;                &lt;h3 class=&quot;page-title&quot;&gt;Required Readings&lt;/h3&gt;&#10;                &lt;p class=&quot;semester-info&quot;&gt;Fall 2024 | Prof. Gail Kaiser&lt;/p&gt;&#10;            &lt;/div&gt;&#10;&#10;            {% if service_status %}&#10;            &lt;div class=&quot;status-indicator success&quot;&gt;&#10;                &lt;span class=&quot;status-dot&quot;&gt;&lt;/span&gt;&#10;                Citation Service: Connected&#10;            &lt;/div&gt;&#10;            {% else %}&#10;            &lt;div class=&quot;status-indicator error&quot;&gt;&#10;                &lt;span class=&quot;status-dot&quot;&gt;&lt;/span&gt;&#10;                Citation Service: Unavailable&#10;            &lt;/div&gt;&#10;            {% endif %}&#10;&#10;            &lt;div class=&quot;readings-list&quot;&gt;&#10;                {% for reading in readings %}&#10;                &lt;div class=&quot;reading-item&quot;&gt;&#10;                    &lt;div class=&quot;reading-header&quot;&gt;&#10;                        &lt;span class=&quot;reading-type {{ reading.type.lower() }}&quot;&gt;{{ reading.type }}&lt;/span&gt;&#10;                        &lt;h4 class=&quot;reading-title&quot;&gt;{{ reading.title }}&lt;/h4&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;div class=&quot;reading-details&quot;&gt;&#10;                        &lt;p class=&quot;author&quot;&gt;&lt;strong&gt;Author:&lt;/strong&gt; {{ reading.author }}&lt;/p&gt;&#10;                        {% if reading.type == 'BOOK' %}&#10;                            {% if reading.publisher %}&lt;p&gt;&lt;strong&gt;Publisher:&lt;/strong&gt; {{ reading.publisher }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.isbn %}&lt;p&gt;&lt;strong&gt;ISBN:&lt;/strong&gt; {{ reading.isbn }}&lt;/p&gt;{% endif %}&#10;                        {% elif reading.type == 'ARTICLE' %}&#10;                            {% if reading.journal %}&lt;p&gt;&lt;strong&gt;Journal:&lt;/strong&gt; {{ reading.journal }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.doi %}&lt;p&gt;&lt;strong&gt;DOI:&lt;/strong&gt; {{ reading.doi }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.volume %}&lt;p&gt;&lt;strong&gt;Volume:&lt;/strong&gt; {{ reading.volume }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.issue %}&lt;p&gt;&lt;strong&gt;Issue:&lt;/strong&gt; {{ reading.issue }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.pages %}&lt;p&gt;&lt;strong&gt;Pages:&lt;/strong&gt; {{ reading.pages }}&lt;/p&gt;{% endif %}&#10;                        {% elif reading.type == 'VIDEO' %}&#10;                            {% if reading.platform %}&lt;p&gt;&lt;strong&gt;Platform:&lt;/strong&gt; {{ reading.platform }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.url %}&lt;p&gt;&lt;strong&gt;URL:&lt;/strong&gt; &lt;a href=&quot;{{ reading.url }}&quot; target=&quot;_blank&quot;&gt;{{ reading.url }}&lt;/a&gt;&lt;/p&gt;{% endif %}&#10;                            {% if reading.duration %}&lt;p&gt;&lt;strong&gt;Duration:&lt;/strong&gt; {{ reading.duration // 60 }}:{{ '{:02d}'.format(reading.duration % 60) }}&lt;/p&gt;{% endif %}&#10;                        {% endif %}&#10;                        {% if reading.year %}&lt;p&gt;&lt;strong&gt;Year:&lt;/strong&gt; {{ reading.year }}&lt;/p&gt;{% endif %}&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;div class=&quot;citation-controls&quot;&gt;&#10;                        &lt;div class=&quot;citation-form&quot;&gt;&#10;                            &lt;label for=&quot;style-{{ reading.id }}&quot; class=&quot;style-label&quot;&gt;Citation Style:&lt;/label&gt;&#10;                            &lt;select id=&quot;style-{{ reading.id }}&quot; class=&quot;style-select&quot;&gt;&#10;                                &lt;option value=&quot;MLA&quot;&gt;MLA&lt;/option&gt;&#10;                                &lt;option value=&quot;APA&quot;&gt;APA&lt;/option&gt;&#10;                                &lt;option value=&quot;CHICAGO&quot;&gt;Chicago&lt;/option&gt;&#10;                            &lt;/select&gt;&#10;                            &lt;button class=&quot;generate-btn&quot; onclick=&quot;generateCitation({{ reading.id }}, '{{ reading.type }}')&quot;&gt;&#10;                                Generate Citation&#10;                            &lt;/button&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div id=&quot;citation-{{ reading.id }}&quot; class=&quot;citation-result&quot; style=&quot;display: none;&quot;&gt;&#10;                            &lt;h5&gt;Generated Citation:&lt;/h5&gt;&#10;                            &lt;div class=&quot;citation-text&quot;&gt;&lt;/div&gt;&#10;                            &lt;button class=&quot;copy-btn&quot; onclick=&quot;copyCitation({{ reading.id }})&quot;&gt;Copy to Clipboard&lt;/button&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div id=&quot;loading-{{ reading.id }}&quot; class=&quot;loading&quot; style=&quot;display: none;&quot;&gt;&#10;                            &lt;div class=&quot;spinner&quot;&gt;&lt;/div&gt;&#10;                            &lt;span&gt;Generating citation...&lt;/span&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div id=&quot;error-{{ reading.id }}&quot; class=&quot;error-message&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;                {% endfor %}&#10;            &lt;/div&gt;&#10;        &lt;/main&gt;&#10;&#10;        &lt;footer class=&quot;footer&quot;&gt;&#10;            &lt;p&gt;&amp;copy; 2024 Columbia University Libraries | Citation Service Integration Demo&lt;/p&gt;&#10;            &lt;p&gt;This application demonstrates integration with the Citation Service API for academic resource management.&lt;/p&gt;&#10;        &lt;/footer&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;script&gt;&#10;        async function generateCitation(sourceId, sourceType) {&#10;            const styleSelect = document.getElementById(`style-${sourceId}`);&#10;            const style = styleSelect.value;&#10;            const citationDiv = document.getElementById(`citation-${sourceId}`);&#10;            const loadingDiv = document.getElementById(`loading-${sourceId}`);&#10;            const errorDiv = document.getElementById(`error-${sourceId}`);&#10;            const generateBtn = document.querySelector(`button[onclick*=&quot;generateCitation(${sourceId}&quot;]`);&#10;&#10;            // Hide previous results&#10;            citationDiv.style.display = 'none';&#10;            errorDiv.style.display = 'none';&#10;&#10;            // Show loading state&#10;            loadingDiv.style.display = 'flex';&#10;            generateBtn.disabled = true;&#10;            generateBtn.textContent = 'Generating...';&#10;&#10;            try {&#10;                const response = await fetch('/generate_citation', {&#10;                    method: 'POST',&#10;                    headers: {&#10;                        'Content-Type': 'application/json',&#10;                    },&#10;                    body: JSON.stringify({&#10;                        source_id: sourceId,&#10;                        source_type: sourceType,&#10;                        style: style&#10;                    })&#10;                });&#10;&#10;                const data = await response.json();&#10;&#10;                if (data.success) {&#10;                    const citationText = citationDiv.querySelector('.citation-text');&#10;                    citationText.textContent = data.citation;&#10;                    citationDiv.style.display = 'block';&#10;                } else {&#10;                    errorDiv.textContent = data.error || 'Failed to generate citation';&#10;                    errorDiv.style.display = 'block';&#10;                }&#10;            } catch (error) {&#10;                errorDiv.textContent = 'Network error: Unable to generate citation';&#10;                errorDiv.style.display = 'block';&#10;            } finally {&#10;                // Hide loading state&#10;                loadingDiv.style.display = 'none';&#10;                generateBtn.disabled = false;&#10;                generateBtn.textContent = 'Generate Citation';&#10;            }&#10;        }&#10;&#10;        async function copyCitation(sourceId) {&#10;            const citationText = document.querySelector(`#citation-${sourceId} .citation-text`).textContent;&#10;&#10;            try {&#10;                await navigator.clipboard.writeText(citationText);&#10;&#10;                const copyBtn = document.querySelector(`#citation-${sourceId} .copy-btn`);&#10;                const originalText = copyBtn.textContent;&#10;                copyBtn.textContent = 'Copied!';&#10;                copyBtn.classList.add('copied');&#10;&#10;                setTimeout(() =&gt; {&#10;                    copyBtn.textContent = originalText;&#10;                    copyBtn.classList.remove('copied');&#10;                }, 2000);&#10;            } catch (error) {&#10;                console.error('Failed to copy citation:', error);&#10;                alert('Failed to copy citation to clipboard');&#10;            }&#10;        }&#10;&#10;        // Check service status on page load&#10;        document.addEventListener('DOMContentLoaded', function() {&#10;            const statusIndicator = document.querySelector('.status-indicator');&#10;            if (!statusIndicator.classList.contains('success')) {&#10;                // Show warning for unavailable service&#10;                const warning = document.createElement('div');&#10;                warning.className = 'service-warning';&#10;                warning.innerHTML = '&lt;strong&gt;Note:&lt;/strong&gt; Citation generation is currently unavailable. Please ensure the Citation Service is running on localhost:8081.';&#10;                document.querySelector('.main-content').insertBefore(warning, document.querySelector('.readings-list'));&#10;            }&#10;        });&#10;    &lt;/script&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;" />
              <option name="updatedContent" value="&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Columbia University Library - Required Readings&lt;/title&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;{{ url_for('static', filename='style.css') }}&quot;&gt;&#10;    &lt;link href=&quot;https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;    &lt;div class=&quot;container&quot;&gt;&#10;        &lt;header class=&quot;header&quot;&gt;&#10;            &lt;div class=&quot;university-logo&quot;&gt;&#10;                &lt;h1&gt;Columbia University Libraries&lt;/h1&gt;&#10;                &lt;p class=&quot;subtitle&quot;&gt;Academic Resource Management System&lt;/p&gt;&#10;            &lt;/div&gt;&#10;        &lt;/header&gt;&#10;&#10;        &lt;main class=&quot;main-content&quot;&gt;&#10;            &lt;div class=&quot;course-header&quot;&gt;&#10;                &lt;h2 class=&quot;course-title&quot;&gt;COMS W 4156: Advanced Software Engineering&lt;/h2&gt;&#10;                &lt;h3 class=&quot;page-title&quot;&gt;Required Readings&lt;/h3&gt;&#10;                &lt;p class=&quot;semester-info&quot;&gt;Fall 2024 | Prof. Gail Kaiser&lt;/p&gt;&#10;            &lt;/div&gt;&#10;&#10;            {% if service_status %}&#10;            &lt;div class=&quot;status-indicator success&quot;&gt;&#10;                &lt;span class=&quot;status-dot&quot;&gt;&lt;/span&gt;&#10;                Citation Service: Connected&#10;            &lt;/div&gt;&#10;            {% else %}&#10;            &lt;div class=&quot;status-indicator error&quot;&gt;&#10;                &lt;span class=&quot;status-dot&quot;&gt;&lt;/span&gt;&#10;                Citation Service: Unavailable&#10;            &lt;/div&gt;&#10;            {% endif %}&#10;&#10;            &lt;div class=&quot;readings-list&quot;&gt;&#10;                {% for reading in readings %}&#10;                &lt;div class=&quot;reading-item&quot;&gt;&#10;                    &lt;div class=&quot;reading-header&quot;&gt;&#10;                        &lt;span class=&quot;reading-type {{ reading.get('type', 'UNKNOWN').lower() }}&quot;&gt;{{ reading.get('type', 'UNKNOWN') }}&lt;/span&gt;&#10;                        &lt;h4 class=&quot;reading-title&quot;&gt;{{ reading.title }}&lt;/h4&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;div class=&quot;reading-details&quot;&gt;&#10;                        &lt;p class=&quot;author&quot;&gt;&lt;strong&gt;Author:&lt;/strong&gt; {{ reading.author }}&lt;/p&gt;&#10;                        {% if reading.get('type') == 'BOOK' %}&#10;                            {% if reading.get('publisher') %}&lt;p&gt;&lt;strong&gt;Publisher:&lt;/strong&gt; {{ reading.publisher }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('isbn') %}&lt;p&gt;&lt;strong&gt;ISBN:&lt;/strong&gt; {{ reading.isbn }}&lt;/p&gt;{% endif %}&#10;                        {% elif reading.get('type') == 'ARTICLE' %}&#10;                            {% if reading.get('journal') %}&lt;p&gt;&lt;strong&gt;Journal:&lt;/strong&gt; {{ reading.journal }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('doi') %}&lt;p&gt;&lt;strong&gt;DOI:&lt;/strong&gt; {{ reading.doi }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('volume') %}&lt;p&gt;&lt;strong&gt;Volume:&lt;/strong&gt; {{ reading.volume }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('issue') %}&lt;p&gt;&lt;strong&gt;Issue:&lt;/strong&gt; {{ reading.issue }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('pages') %}&lt;p&gt;&lt;strong&gt;Pages:&lt;/strong&gt; {{ reading.pages }}&lt;/p&gt;{% endif %}&#10;                        {% elif reading.get('type') == 'VIDEO' %}&#10;                            {% if reading.get('platform') %}&lt;p&gt;&lt;strong&gt;Platform:&lt;/strong&gt; {{ reading.platform }}&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('url') %}&lt;p&gt;&lt;strong&gt;URL:&lt;/strong&gt; &lt;a href=&quot;{{ reading.url }}&quot; target=&quot;_blank&quot;&gt;{{ reading.url }}&lt;/a&gt;&lt;/p&gt;{% endif %}&#10;                            {% if reading.get('duration') %}&lt;p&gt;&lt;strong&gt;Duration:&lt;/strong&gt; {{ reading.duration // 60 }}:{{ '{:02d}'.format(reading.duration % 60) }}&lt;/p&gt;{% endif %}&#10;                        {% endif %}&#10;                        {% if reading.get('year') or reading.get('publicationYear') %}&lt;p&gt;&lt;strong&gt;Year:&lt;/strong&gt; {{ reading.get('year', reading.get('publicationYear', 'N/A')) }}&lt;/p&gt;{% endif %}&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;div class=&quot;citation-controls&quot;&gt;&#10;                        &lt;div class=&quot;citation-form&quot;&gt;&#10;                            &lt;label for=&quot;style-{{ reading.id }}&quot; class=&quot;style-label&quot;&gt;Citation Style:&lt;/label&gt;&#10;                            &lt;select id=&quot;style-{{ reading.id }}&quot; class=&quot;style-select&quot;&gt;&#10;                                &lt;option value=&quot;MLA&quot;&gt;MLA&lt;/option&gt;&#10;                                &lt;option value=&quot;APA&quot;&gt;APA&lt;/option&gt;&#10;                                &lt;option value=&quot;CHICAGO&quot;&gt;Chicago&lt;/option&gt;&#10;                            &lt;/select&gt;&#10;                            &lt;button class=&quot;generate-btn&quot; onclick=&quot;generateCitation({{ reading.id }}, '{{ reading.get('type', 'BOOK') }}')&quot;&gt;&#10;                                Generate Citation&#10;                            &lt;/button&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div id=&quot;citation-{{ reading.id }}&quot; class=&quot;citation-result&quot; style=&quot;display: none;&quot;&gt;&#10;                            &lt;h5&gt;Generated Citation:&lt;/h5&gt;&#10;                            &lt;div class=&quot;citation-text&quot;&gt;&lt;/div&gt;&#10;                            &lt;button class=&quot;copy-btn&quot; onclick=&quot;copyCitation({{ reading.id }})&quot;&gt;Copy to Clipboard&lt;/button&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div id=&quot;loading-{{ reading.id }}&quot; class=&quot;loading&quot; style=&quot;display: none;&quot;&gt;&#10;                            &lt;div class=&quot;spinner&quot;&gt;&lt;/div&gt;&#10;                            &lt;span&gt;Generating citation...&lt;/span&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;div id=&quot;error-{{ reading.id }}&quot; class=&quot;error-message&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;                {% endfor %}&#10;            &lt;/div&gt;&#10;        &lt;/main&gt;&#10;&#10;        &lt;footer class=&quot;footer&quot;&gt;&#10;            &lt;p&gt;&amp;copy; 2024 Columbia University Libraries | Citation Service Integration Demo&lt;/p&gt;&#10;            &lt;p&gt;This application demonstrates integration with the Citation Service API for academic resource management.&lt;/p&gt;&#10;        &lt;/footer&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;script&gt;&#10;        async function generateCitation(sourceId, sourceType) {&#10;            const styleSelect = document.getElementById(`style-${sourceId}`);&#10;            const style = styleSelect.value;&#10;            const citationDiv = document.getElementById(`citation-${sourceId}`);&#10;            const loadingDiv = document.getElementById(`loading-${sourceId}`);&#10;            const errorDiv = document.getElementById(`error-${sourceId}`);&#10;            const generateBtn = document.querySelector(`button[onclick*=&quot;generateCitation(${sourceId}&quot;]`);&#10;&#10;            // Hide previous results&#10;            citationDiv.style.display = 'none';&#10;            errorDiv.style.display = 'none';&#10;&#10;            // Show loading state&#10;            loadingDiv.style.display = 'flex';&#10;            generateBtn.disabled = true;&#10;            generateBtn.textContent = 'Generating...';&#10;&#10;            try {&#10;                const response = await fetch('/generate_citation', {&#10;                    method: 'POST',&#10;                    headers: {&#10;                        'Content-Type': 'application/json',&#10;                    },&#10;                    body: JSON.stringify({&#10;                        source_id: sourceId,&#10;                        source_type: sourceType,&#10;                        style: style&#10;                    })&#10;                });&#10;&#10;                const data = await response.json();&#10;&#10;                if (data.success) {&#10;                    const citationText = citationDiv.querySelector('.citation-text');&#10;                    citationText.textContent = data.citation;&#10;                    citationDiv.style.display = 'block';&#10;                } else {&#10;                    errorDiv.textContent = data.error || 'Failed to generate citation';&#10;                    errorDiv.style.display = 'block';&#10;                }&#10;            } catch (error) {&#10;                errorDiv.textContent = 'Network error: Unable to generate citation';&#10;                errorDiv.style.display = 'block';&#10;            } finally {&#10;                // Hide loading state&#10;                loadingDiv.style.display = 'none';&#10;                generateBtn.disabled = false;&#10;                generateBtn.textContent = 'Generate Citation';&#10;            }&#10;        }&#10;&#10;        async function copyCitation(sourceId) {&#10;            const citationText = document.querySelector(`#citation-${sourceId} .citation-text`).textContent;&#10;&#10;            try {&#10;                await navigator.clipboard.writeText(citationText);&#10;&#10;                const copyBtn = document.querySelector(`#citation-${sourceId} .copy-btn`);&#10;                const originalText = copyBtn.textContent;&#10;                copyBtn.textContent = 'Copied!';&#10;                copyBtn.classList.add('copied');&#10;&#10;                setTimeout(() =&gt; {&#10;                    copyBtn.textContent = originalText;&#10;                    copyBtn.classList.remove('copied');&#10;                }, 2000);&#10;            } catch (error) {&#10;                console.error('Failed to copy citation:', error);&#10;                alert('Failed to copy citation to clipboard');&#10;            }&#10;        }&#10;&#10;        // Check service status on page load&#10;        document.addEventListener('DOMContentLoaded', function() {&#10;            const statusIndicator = document.querySelector('.status-indicator');&#10;            if (!statusIndicator.classList.contains('success')) {&#10;                // Show warning for unavailable service&#10;                const warning = document.createElement('div');&#10;                warning.className = 'service-warning';&#10;                warning.innerHTML = '&lt;strong&gt;Note:&lt;/strong&gt; Citation generation is currently unavailable. Please ensure the Citation Service is running on localhost:8081.';&#10;                document.querySelector('.main-content').insertBefore(warning, document.querySelector('.readings-list'));&#10;            }&#10;        });&#10;    &lt;/script&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/columbia/coms4156/citationservice/model/Media.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/columbia/coms4156/citationservice/model/Media.java" />
              <option name="originalContent" value="package com.columbia.coms4156.citationservice.model;&#10;&#10;import jakarta.persistence.*;&#10;import jakarta.validation.constraints.NotBlank;&#10;&#10;/**&#10; * Abstract base class for different media types (Book, Video, Article, etc.).&#10; * Contains the common fields shared by all media.&#10; */&#10;@MappedSuperclass&#10;public abstract class Media {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @NotBlank(message = &quot;Title is required&quot;)&#10;    @Column(nullable = false)&#10;    private String title;&#10;&#10;    @NotBlank(message = &quot;Author is required&quot;)&#10;    @Column(nullable = false)&#10;    private String author;&#10;&#10;    public Media() {}&#10;&#10;    public Media(String title, String author) {&#10;        this.title = title;&#10;        this.author = author;&#10;    }&#10;&#10;    public Long getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(Long id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public String getTitle() {&#10;        return title;&#10;    }&#10;&#10;    public void setTitle(String title) {&#10;        this.title = title;&#10;    }&#10;&#10;    public String getAuthor() {&#10;        return author;&#10;    }&#10;&#10;    public void setAuthor(String author) {&#10;        this.author = author;&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Media{&quot; +&#10;                &quot;id=&quot; + id +&#10;                &quot;, title='&quot; + title + '\'' +&#10;                &quot;, author='&quot; + author + '\'' +&#10;                '}';&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.columbia.coms4156.citationservice.model;&#10;&#10;import jakarta.persistence.*;&#10;import jakarta.validation.constraints.NotBlank;&#10;&#10;/**&#10; * Abstract base class for different media types (Book, Video, Article, etc.).&#10; * Contains the common fields shared by all media.&#10; */&#10;@MappedSuperclass&#10;public abstract class Media {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @NotBlank(message = &quot;Title is required&quot;)&#10;    @Column(nullable = false)&#10;    private String title;&#10;&#10;    @NotBlank(message = &quot;Author is required&quot;)&#10;    @Column(nullable = false)&#10;    private String author;&#10;&#10;    public Media() {}&#10;&#10;    public Media(String title, String author) {&#10;        this.title = title;&#10;        this.author = author;&#10;    }&#10;&#10;    public Long getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(Long id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public String getTitle() {&#10;        return title;&#10;    }&#10;&#10;    public void setTitle(String title) {&#10;        this.title = title;&#10;    }&#10;&#10;    public String getAuthor() {&#10;        return author;&#10;    }&#10;&#10;    public void setAuthor(String author) {&#10;        this.author = author;&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Media{&quot; +&#10;                &quot;id=&quot; + id +&#10;                &quot;, title='&quot; + title + '\'' +&#10;                &quot;, author='&quot; + author + '\'' +&#10;                '}';&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>